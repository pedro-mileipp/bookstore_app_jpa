# üìö Bookstore App JPA

[![Java](https://img.shields.io/badge/Java-21-007396?style=for-the-badge&logo=openjdk)](https://www.oracle.com/java/)
[![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.0.0-6DB33F?style=for-the-badge&logo=springboot)](https://spring.io/projects/spring-boot)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15-4169E1?style=for-the-badge&logo=postgresql)](https://www.postgresql.org/)
[![Maven](https://img.shields.io/badge/Maven-3.9.0-C71A36?style=for-the-badge&logo=apachemaven)](https://maven.apache.org/)
[![License](https://img.shields.io/badge/license-MIT-blue?style=for-the-badge)](LICENSE)

# üöÄ Objetivo
- Criar uma aplica√ß√£o de um Bookstore para praticar JPA, Spring e PostgreSQL

# Prepara√ß√£o do Ambiente
- Requisitos necess√°rios:
    - JDK 21 
    - Maven
    - Postman
    - PgAdmin (Postgres)
    - IDE (IntelliJ, STS, Eclipse, VSCode, etc)

# Iniciando o projeto
- Para come√ßar, gere o projeto no [Spring Initializr](https://start.spring.io/)
- As depend√™ncias necess√°rias a serem adicionadas s√£o:
    - Spring Web
    - Spring Data JPA
    - PostgreSQL Driver
- Escolha o Maven como Project, linguagem Java e a vers√£o 21.
- A imagem abaixo ilustra como deve ser feita a configura√ß√£o:

<img src="./images/initializr.png" width=70% alt="Depend√™ncias no Spring Initializr">


<br>

# Diagrama UML de Classes

<img src="./images/Bookstore_App_Diagram.png">


<br>


# SHOW ME THE CODE!!!

## üèó Arquitetura do Projeto
- O projeto segue uma arquitetura em m√∫ltiplas camadas com separa√ß√£o clara de responsabilidades.
- Essa abordagem facilita testes, manuten√ß√£o e evolu√ß√£o do c√≥digo.

## 1Ô∏è‚É£ Camada Controller ‚Äî Interface com o Cliente
üìÇ **Pacote:** `controller`  
- Recebe requisi√ß√µes HTTP via **endpoints REST**.
- Converte dados recebidos em **DTOs** e envia para o **Service**.
- Retorna respostas padronizadas (`ResponseEntity`), encapsulando status e corpo.
- **N√£o cont√©m l√≥gica de neg√≥cio**.

- Exemplo:
```java
@RestController
@RequestMapping("/books")
public class BookController {

    private final BookService bookService;

    public BookController(BookService bookService) {
        this.bookService = bookService;
    }

    @GetMapping("/{id}")
    public ResponseEntity<BookDTO> findById(@PathVariable Long id) {
        return ResponseEntity.ok(bookService.findById(id));
    }

    @PostMapping
    public ResponseEntity<BookDTO> create(@RequestBody BookDTO bookDTO) {
        return ResponseEntity.status(HttpStatus.CREATED).body(bookService.create(bookDTO));
    }
}
```

## 2Ô∏è‚É£ Camada Service ‚Äî Regras de Neg√≥cio
üìÇ Pacote: service
- Cont√©m toda a l√≥gica de neg√≥cio e valida√ß√µes.
- Converte DTOs em Entities e vice-versa.
- Orquestra opera√ß√µes de persist√™ncia via Repository.
- Pode lan√ßar exce√ß√µes personalizadas (BookNotFoundException).
- Exemplo    
```java
@Service
public class BookService {

    private final BookRepository bookRepository;

    public BookService(BookRepository bookRepository) {
        this.bookRepository = bookRepository;
    }

    public BookDTO findById(Long id) {
        Book book = bookRepository.findById(id)
            .orElseThrow(() -> new BookNotFoundException(id));
        return new BookDTO(book);
    }

    public BookDTO create(BookDTO dto) {
        Book book = new Book(dto);
        return new BookDTO(bookRepository.save(book));
    }
}
```

## Camada Repository ‚Äî Acesso a Dados
üìÇ Pacote: repository
- Interface de comunica√ß√£o com o banco de dados.
- Extende JpaRepository, fornecendo m√©todos prontos (`findAll`, `findById`, `save`, dentre outros).
- Pode conter consultas personalizadas via JPQL ou @Query.

- Exemplo:
```java
@Repository
public interface BookRepository extends JpaRepository<Book, Long> {
    List<Book> findByAuthor(String author);
}
```

## 4Ô∏è‚É£ Camada Model/Entity ‚Äî Mapeamento ORM
üìÇ Pacote: model ou entity
- Representa as tabelas do banco de dados.
- Usa anota√ß√µes JPA para mapear atributos (@Entity, @Table, @Column, @Id).
- Pode conter relacionamentos (@OneToMany, @ManyToOne).
- Exemplo:
```java
@Entity
@Table(name = "books")
public class Book {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(nullable = false)
    private String title;

    @Column(nullable = false)
    private String author;

    @Column(nullable = false)
    private Double price;

    public Book() {}
    
    public Book(BookDTO dto) {
        this.title = dto.getTitle();
        this.author = dto.getAuthor();
        this.price = dto.getPrice();
    }
}
```

## 5Ô∏è‚É£ DTOs (Data Transfer Objects)
üìÇ Pacote: dto
- Objetos simples usados para transportar dados.
- Evitam exposi√ß√£o direta das entidades.
- Facilitam valida√ß√µes e garantem seguran√ßa.
- Exemplo:
```java
public class BookDTO {
    private Long id;
    private String title;
    private String author;
    private Double price;

    public BookDTO() {}
    
    public BookDTO(Book entity) {
        this.id = entity.getId();
        this.title = entity.getTitle();
        this.author = entity.getAuthor();
        this.price = entity.getPrice();
    }
}
```

## üóÑ Estrutura de Banco de Dados
- Gerenciada automaticamente pelo Hibernate a partir das entidades.
- Exemplo de cria√ß√£o de tabela:
```sql
CREATE TABLE books (
id SERIAL PRIMARY KEY,
title VARCHAR(255) NOT NULL,
author VARCHAR(255) NOT NULL,
price DECIMAL(10,2) NOT NULL
);
```
## ‚öôÔ∏è Como Executar

```bash
# Clonar o reposit√≥rio
git clone https://github.com/pedro-mileipp/bookstore_app_jpa.git

# Configurar o application.properties
spring.datasource.url=jdbc:postgresql://localhost:[porta_do_banco]/[database]
spring.datasource.username=SEU_USUARIO
spring.datasource.password=SUA_SENHA

# Na pasta, executar o comando abaixo
./mvnw spring-boot:run
```